!function(){function e(e){return!isNaN(parseFloat(e))&&isFinite(e)}var t=0,o=1e3,r=3,l=[{name:"timeframe",display_name:"Timeframe (s)",type:"text",description:"Specify the last number of seconds you want to see.",default_value:60},{name:"blocks",display_name:"Height (No. Blocks)",type:"text",default_value:4},{name:"chartType",display_name:"Chart Type",type:"option",options:[{name:"Area",value:"area"},{name:"Spline",value:"spline"}]},{name:"title",display_name:"Title",type:"text"},{name:"xaxis",display_name:"X-Axis",type:"calculated",default_value:'{"title":{"text" : "Time"}, "type": "datetime", "floor":0}'},{name:"yaxis",display_name:"Y-Axis",type:"calculated",default_value:'{"title":{"text" : "Values"}, "minorTickInterval":"auto", "floor":0}'}];for(i=1;i<=r;i++){var a={name:"series"+i,display_name:"Series "+i+" - Datasource",type:"calculated"},s={name:"series"+i+"label",display_name:"Series "+i+" - Label",type:"text"};l.push(a),l.push(s)}freeboard.loadWidgetPlugin({type_name:"highcharts-timeseries",display_name:"Time series (Highcharts)",description:"Time series line chart.",external_scripts:["https://code.highcharts.com/highcharts.js","https://code.highcharts.com/modules/exporting.js"],fill_size:!0,settings:l,newInstance:function(e,t){t(new n(e))}});var n=function(l){function a(){Highcharts.theme={global:{useUTC:!1},colors:["#2b908f","#90ee7e","#f45b5b","#7798BF","#aaeeee","#ff0066","#eeaaee","#55BF3B","#DF5353","#7798BF","#aaeeee"],chart:{backgroundColor:null,style:{fontFamily:"'Open Sans', sans-serif"},plotBorderColor:"#606063"},title:{style:{color:"#E0E0E3",fontSize:"20px"}},subtitle:{style:{color:"#E0E0E3",textTransform:"uppercase"}},xAxis:{gridLineColor:"#707073",labels:{style:{color:"#E0E0E3"}},lineColor:"#707073",minorGridLineColor:"#505053",tickColor:"#707073",title:{style:{color:"#A0A0A3"}}},yAxis:{gridLineColor:"#707073",labels:{style:{color:"#E0E0E3"}},lineColor:"#707073",minorGridLineColor:"#505053",tickColor:"#707073",tickWidth:1,title:{style:{color:"#A0A0A3"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.85)",style:{color:"#F0F0F0"}},plotOptions:{series:{dataLabels:{color:"#B0B0B3"},marker:{lineColor:"#333"}},boxplot:{fillColor:"#505053"},candlestick:{lineColor:"white"},errorbar:{color:"white"}},legend:{itemStyle:{color:"#E0E0E3"},itemHoverStyle:{color:"#FFF"},itemHiddenStyle:{color:"#606063"}},credits:{style:{color:"#666"}},labels:{style:{color:"#707073"}},drilldown:{activeAxisLabelStyle:{color:"#F0F0F3"},activeDataLabelStyle:{color:"#F0F0F3"}},navigation:{buttonOptions:{symbolStroke:"#DDDDDD",theme:{fill:"#505053"}}},rangeSelector:{buttonTheme:{fill:"#505053",stroke:"#000000",style:{color:"#CCC"},states:{hover:{fill:"#707073",stroke:"#000000",style:{color:"white"}},select:{fill:"#000003",stroke:"#000000",style:{color:"white"}}}},inputBoxBorderColor:"#505053",inputStyle:{backgroundColor:"#333",color:"silver"},labelStyle:{color:"silver"}},navigator:{handles:{backgroundColor:"#666",borderColor:"#AAA"},outlineColor:"#CCC",maskFill:"rgba(255,255,255,0.1)",series:{color:"#7798BF",lineColor:"#A6C7ED"},xAxis:{gridLineColor:"#505053"}},scrollbar:{barBackgroundColor:"#808083",barBorderColor:"#808083",buttonArrowColor:"#CCC",buttonBackgroundColor:"#606063",buttonBorderColor:"#606063",rifleColor:"#FFF",trackBackgroundColor:"#404043",trackBorderColor:"#404043"},legendBackgroundColor:"rgba(0, 0, 0, 0.5)",background2:"#505053",dataLabelsColor:"#B0B0B3",textColor:"#C0C0C0",contrastTextColor:"#F0F0F3",maskColor:"rgba(255,255,255,0.3)"},Highcharts.setOptions(Highcharts.theme);var e=JSON.parse(n.xaxis),t=JSON.parse(n.yaxis),o=n.title,l=n.chartType,a=[];for(i=1;i<=r;i++){var c=n["series"+i];if(c){var d="series"+i+"label",g=n[d];console.log("label: ",g);var m={id:"series"+i,name:g,fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,Highcharts.getOptions().colors[i-1]],[1,Highcharts.Color(Highcharts.getOptions().colors[i-1]).setOpacity(0).get("rgba")]]},data:[],connectNulls:!0};a.push(m)}}h.css("height",60*s.getHeight()-10+"px"),h.css("width","100%"),h.highcharts({chart:{type:l,animation:Highcharts.svg,marginRight:20},title:{text:o},xAxis:e,yAxis:t,plotOptions:{area:{marker:{enabled:!1,symbol:"circle",radius:2,hover:{enabled:!0}},lineWidth:2,states:{hover:{lineWidth:2}},threshold:null}},tooltip:{formatter:function(){return"<b>"+this.series.name+"</b><br/>"+Highcharts.dateFormat("%Y-%m-%d %H:%M:%S",this.x)+"<br/>"+Highcharts.numberFormat(this.y,1)}},series:a})}var s=this,n=l,c="highcharts-widget-timeseries-"+t++,h=$('<div class="highcharts-widget" id="'+c+'"></div>');s.render=function(e){$(e).append(h),a()},s.getHeight=function(){return n.blocks},s.onSettingsChanged=function(e){n=e,a()},s.onCalculatedValueChanged=function(t,r){var i=h.highcharts(),l=i.get(t);if(l){var a=n.timeframe*o,s=(l.data.length,!1);if(l.data.length>1){var c=l.data[0].x,d=(new Date).getTime();d-c>a&&(s=!0)}if(e(r)){var g=(new Date).getTime(),m=[g,Number(r)];l.addPoint(m,!0,s)}}},s.onDispose=function(){}}}();
